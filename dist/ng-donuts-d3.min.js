/**
 * ng-donuts-d3
 * @version v0.0.1 - 2015-06-24
 * @link https://github.com/hugomosh/ng-donuts-d3
 * @author  <>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("ngDonutsD3",[]).directive("myDirective",function(){return{restrict:"EAC",scope:!0,compile:function(a,b,c){return a.html("<span>hello {{name}}</span>"),function(a,b,c,d){a.name="world"}}}}).directive("arcod3",["$window",function(a){return{template:"<svg></svg>",restrict:"EA",scope:{porcentaje:"=",funcioncolor:"=?",texto:"=?"},link:function(b,c,d){function e(a,b){a.attrTween("d",function(a){var c=g.interpolate(a.endAngle,b);return function(b){return a.endAngle=c(b),q(a)}})}var f=2*Math.PI;b.porcentaje||(b.porcentaje=50),b.funcioncolor||(b.funcioncolor=function(a){return"purple"});var g=a.d3;console.log(g);var h=c.find("svg")[0],i=g.select(h);c.height()||c.height(c.width());var j=Math.min(c.width(),c.height());j&&0!==j||(j=100),i.style("width","100%").style("height","100%").attr("viewBox","0, 0, "+j+", "+j).attr("preserveAspectRatio","xMinYMin");var k,l,m,n=.05*j,o=Math.ceil(.3*n),p=j/2-o,q=g.svg.arc().innerRadius(p-n).outerRadius(p).startAngle(0),r=function(){i.select("g").remove();var a=i.append("g").attr("transform","translate("+j/2+","+j/2+")"),c=g.svg.arc().startAngle(0).endAngle(f).innerRadius(p-n+o).outerRadius(p-o);if(k=g.svg.arc().startAngle(0).endAngle(0).innerRadius(p-n).outerRadius(p),a.append("path").attr("d",c).attr("fill",function(){return"#eee"}),l=a.append("path").datum({endAngle:0}).attr("d",k).attr("fill",function(){return b.funcioncolor(b.porcentaje)}),b.texto){var d=j/4;m=a.append("text").text(b.texto).attr("text-anchor","middle").attr("dx",2).attr("class","arcod3-texto"),d=m.style("font-size").replace("px",""),m.attr("dy",d/3)}l.transition().duration(2e3).call(e,b.porcentaje/100*f)};r(),b.$watch("porcentaje",function(a,b){a&&(console.log("Build arc3"),r())})}}}]).directive("donoutChart",["$window",function(a){var b=2*Math.PI,c=function(c,d,e){function f(a,b){a.attrTween("d",function(a){var c=g.interpolate(a.endAngle,b);return function(b){return a.endAngle=c(b),q(a)}})}c.value||(c.value=50),c.total&&0!==c.total||(c.total=100),c.percentage=c.value/c.total,c.color?c.colorfun=function(){return String(c.color).replace("'","")}:c.colorfun||(c.colorfun=function(a){return"orange"});var g=a.d3,h=d.find("svg")[0],i=g.select(h),j=Math.min(d.width(),d.height());j&&0!==j||(j=100),i.style("width","100%").style("height","100%").attr("viewBox","0, 0, "+j+", "+j).attr("preserveAspectRatio","xMinYMin");var k,l,m=.05,n=j*m,o=Math.ceil(.3*n),p=j/2-o,q=g.svg.arc().innerRadius(p-n).outerRadius(p).startAngle(0),r=function(){i.select("g").remove();var a=i.append("g").attr("transform","translate("+j/2+","+j/2+")"),d=g.svg.arc().startAngle(0).endAngle(b).innerRadius(p+o-n).outerRadius(p-o),e=g.svg.arc().startAngle(0).endAngle(b).innerRadius(p-n).outerRadius(p);if(a.append("path").attr("d",d).attr("fill",function(){return"#eee"}),k=a.append("path").datum({endAngle:0}).attr("d",e).attr("fill",function(){return c.colorfun(c.percentage)}),k.transition().duration(2e3).call(f,c.percentage*b),c.text){var h=h=p/2;l=a.append("text").text(c.text).attr("text-anchor","middle").attr("dx",2).attr("style","font-size : "+h),l.attr("dy",h/3)}};r(),c.$watch("value",function(a,b){a&&(console.log("Build arc3"),r())})};return{restrict:"EAC",scope:{value:"=?",total:"=",text:"=?",colorfun:"=?",color:"@"},template:'<svg class="donout-chart-svg"></svg>',link:c}}]);